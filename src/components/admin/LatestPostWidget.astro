---
// src/components/admin/LatestPostWidget.astro
import { getCollection } from 'astro:content';

// 1. Ambil 3 postingan terbaru, bukan hanya satu
const posts = (await getCollection('blog'))
  .filter(post => post.data.draft !== true)
  .sort((a,b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3);
---
<div class="bg-zinc-800 rounded-lg p-5">
  
  <div class="flex justify-between items-center mb-4">
    <h3 class="font-semibold text-white">Postingan Terbaru</h3>
    <a href="/blog" target="_blank" class="text-xs text-blue-400 hover:underline font-semibold">
      View All
    </a>
  </div>
  
  {posts.length > 0 ? (
    <ul class="space-y-4">
      {posts.map(post => (
        <li class="border-b border-zinc-700 pb-3 last:border-b-0 last:pb-0">
          <a href={`/blog/${post.slug}`} target="_blank" class="block group">
            <p class="font-medium text-white group-hover:text-blue-400 transition-colors">
              {post.data.title}
            </p>
            <p class="text-xs text-zinc-400 mt-1">
              {post.data.pubDate.toLocaleDateString('id-ID', {day: 'numeric', month: 'long', year: 'numeric'})}
            </p>
          </a>
        </li>
      ))}
    </ul>
  ) : (
    <p class="text-sm text-zinc-400">Belum ada postingan.</p>
  )}

</div>