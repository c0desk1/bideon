---
import { getImageUrl, formatDate, stripHtml } from '../../utils/helpers';

interface RelatedPostData {
  id: string;
  title: string;
  url: string;
  images?: any[];
  published: string;
  summary?: string;
  content?: string;
}

interface Props {
  relatedPosts: RelatedPostData[];
}

const { relatedPosts } = Astro.props;
---

<section class="related-posts-section mt-16 py-8 border-t border-[var(--color-border)]">
  <h3 class="text-2xl font-bold text-center text-[var(--color-text)] mb-8">
    Baca Juga
  </h3>
  
  {relatedPosts && relatedPosts.length > 0 && (
    <div class="
      mobile-carousel-container
      flex overflow-x-auto gap-4 pb-4 snap-x snap-mandatory
      md:grid md:posts-grid md:overflow-x-visible
    ">
      {relatedPosts.map((post) => (
        <article class="
          group flex flex-col snap-start
          w-[80vw] flex-shrink-0 md:w-auto
          rounded-lg border border-[var(--color-border)]
          bg-[var(--color-card-bg)]
          transition-all duration-300 ease-in-out
          hover:border-[var(--color-accent)]
          hover:-translate-y-1
          shadow-sm hover:shadow-lg hover:shadow-[var(--color-accent)]/10
        ">
          <a href={`/post/${post.id}`} class="block">
            <img 
              src={getImageUrl(post)} 
              alt={post.title} 
              class="w-full h-40 object-cover rounded-t-lg"
              loading="lazy" 
              decoding="async"
            />
          </a>
          <div class="p-4 flex flex-col flex-grow">
            <h4 class="text-lg font-semibold text-[var(--color-text)] mb-2 group-hover:text-[var(--color-accent)] transition-colors">
              <a href={`/post/${post.id}`}>{post.title}</a>
            </h4>
            <p class="text-sm text-[var(--color-text-muted)] flex-grow mb-4">
              {stripHtml(post.content || post.summary || '').substring(0, 80)}...
            </p>
            <div class="text-xs text-[var(--color-text-muted)]">
              {formatDate(post.published)}
            </div>
          </div>
        </article>
      ))}
    </div>
  )}
</section>
<style>
  .mobile-carousel-container::-webkit-scrollbar {
    display: none;
  }
  .mobile-carousel-container {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>
