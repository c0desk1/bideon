---
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
  isMain?: boolean;
}

const { post, isMain = false } = Astro.props;

function formatDate(isoDate: string) {
  return new Date(isoDate).toLocaleDateString('id-ID', {
    year: 'numeric', month: 'long', day: 'numeric',
  });
}
---

<a href={`/blog/${post.slug}`} class={`group relative overflow-hidden rounded-xl ${isMain ? 'md:col-span-2 md:row-span-2 flex-col justify-end' : 'flex flex-col justify-end'}`}>
  {post.data.heroImage && (
    <img
      src={post.data.heroImage}
      alt={post.data.title}
      width={600}
      height={400}
      loading="lazy"
      class="absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
    />
  )}
  <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
  <div class={`relative p-${isMain ? '6' : '4'} space-y-3`}>
    <div>
      <div class="flex flex-wrap items-center gap-2 mb-2">
        {post.data.category && (
          <span class="inline-block bg-blue-600 text-white text-xs font-semibold px-2 py-1 rounded-full">
            {post.data.category}
          </span>
        )}
        {post.data.tags?.slice(0, 2).map((tag: string) => (
          <span class="inline-block bg-zinc-700 text-zinc-200 text-xs font-semibold px-2 py-1 rounded-full">{tag}</span>
        ))}
      </div>
      <h3 class={`text-white font-bold ${isMain ? 'text-2xl' : 'text-lg'} line-clamp-2 text-shadow`}>
        {post.data.title}
      </h3>
      {isMain && <p class="text-zinc-300 line-clamp-2 text-shadow">{post.data.description}</p>}
    </div>
    {isMain && (
      <div class="text-shadow flex items-center gap-4 pt-4 border-t border-white/10">
        <div>
          <p class="text-sm font-semibold text-white text-shadow">{post.data.author}</p>
          <p class="text-xs text-zinc-400 text-shadow">{formatDate(post.data.pubDate.toISOString())}</p>
        </div>
      </div>
    )}
  </div>
</a>
