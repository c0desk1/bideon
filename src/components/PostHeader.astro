---
// src/components/blog/PostHeader.astro
interface Props {
  post: {
    title: string;
    url: string; // Add url for potential canonical link, though not directly used in header UI
    published: string;
    images?: Array<{ url: string }>;
    author?: {
      displayName: string;
      url: string;
      image?: {
        url: string;
      };
    };
  };
}

const { post } = Astro.props;

// Helper function to format date
const formatDate = (dateString: string): string => {
  const options: Intl.DateTimeFormatOptions = { year: 'numeric', month: 'long', day: 'numeric' };
  try {
    return new Date(dateString).toLocaleDateString('id-ID', options);
  } catch (e) {
    console.error("Invalid date string provided:", dateString, e);
    return "Invalid Date";
  }
};

// Helper function to get thumbnail URL for a subtle background
const getSubtleBackgroundUrl = (post: Props['post']): string => {
  if (post.images && post.images.length > 0) {
    const imageUrl = post.images[0].url;
    // Get a larger image, but it will be heavily blurred/darkened
    return imageUrl.replace(/s\d+(-c)?/, 's1600-c').replace(/w\d+-h\d+/, 'w1600-h900');
  }
  return ''; // Return empty if no image, for a plain dark background
};

const subtleBgUrl = getSubtleBackgroundUrl(post);
---

<div class="relative w-full overflow-hidden mb-12 py-16 md:py-24 text-white text-center">
    {/* Optional: Subtle background image (blurred/darkened) if available */}
    {subtleBgUrl && (
        <div class="absolute inset-0 z-0 opacity-20 filter blur-xl"> {/* Soft blur for background */}
            <img
                src={subtleBgUrl}
                alt=""
                class="w-full h-full object-cover"
                aria-hidden="true"
            />
            {/* Further darken the background if image is used */}
            <div class="absolute inset-0 bg-black/50"></div>
        </div>
    )}

    {/* Main content area */}
    <div class="relative z-10 max-w-4xl mx-auto px-4 md:px-0">
        {/* Breadcrumb - Clean and understated */}
        <nav class="text-xs md:text-sm font-medium breadcrumbs text-gray-400 mb-6 flex justify-center items-center space-x-2">
            <a href="/" class="hover:text-white transition-colors">Home</a>
            <span class="opacity-50">/</span>
            <a href="/blog" class="hover:text-white transition-colors">Blog</a>
            <span class="opacity-50">/</span>
            <span class="font-semibold text-gray-200 truncate max-w-[150px] md:max-w-xs">{post.title}</span>
        </nav>

        {/* Post Title - Prominent and elegant */}
        <h1 class="text-4xl sm:text-5xl md:text-6xl font-extrabold mb-8 leading-tight tracking-tight text-white">
            {post.title}
        </h1>

        {/* Author and Date Info - Clean and concise */}
        <div class="flex items-center justify-center text-gray-400 text-sm md:text-base font-medium">
            {post.author && post.author.image && (
                <img src={post.author.image.url} alt={post.author.displayName} class="w-7 h-7 rounded-full mr-2 object-cover" />
            )}
            <span>Oleh <span class="font-semibold text-white">{post.author?.displayName || 'Unknown Author'}</span></span>
            <span class="mx-2 opacity-50">&bull;</span>
            <span>{formatDate(post.published)}</span>
            {/* Opsi: Tambah read time atau kategori di sini juga jika ada data */}
        </div>
    </div>
</div>
